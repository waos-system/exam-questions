{
  "genre": "セキュリティ設計・非機能性",
  "exam": "システムアーキテクト試験",
  "category": "sa_security",
  "questions": [
    {
      "id": "sa_security_001",
      "question": "ゼロトラストセキュリティモデルの基本原則として最も適切なものはどれか。",
      "choices": [
        "すべてのユーザーとデバイスを信頼してアクセスを許可する",
        "ネットワーク境界内のトラフィックはすべて信頼できると見なす",
        "信頼をデフォルトとしたうえで、明示的な認証と認可を不可欠とする",
        "VPNの導入により外部からのアクセスを厳密に制限する"
      ],
      "answer": 2,
      "explanation": "ゼロトラストは『信頼はデフォルトではなく、すべてのアクセスを検証する』というモデルです。ユーザー、デバイス、ネットワーク位置に関わらず、常に認証・認可・検証を実施します。これは境界ベースセキュリティの限界を補い、内部脅威や侵害されたデバイスにも対応します。"
    },
    {
      "id": "sa_security_002",
      "question": "公開鍵基盤（PKI）に基づいた認証システムの設計において、秘密鍵の管理方法として最も安全なアプローチはどれか。",
      "choices": [
        "秘密鍵をデータベースに暗号化して保存し、全管理者がアクセス可能にしておく",
        "ハードウェアセキュリティモジュール（HSM）を使用し、秘密鍵をデバイスから抽出不可にする",
        "秘密鍵をテキストファイルで保存し、強力なパスワードで保護する",
        "秘密鍵の複数のコピーを異なるサーバーに保存し、バックアップを確保する"
      ],
      "answer": 1,
      "explanation": "HSM（Hardware Security Module）はトークン化された秘密鍵管理と物理的な改ざん検知機構を提供します。秘密鍵がデバイスから抽出不可な状態で暗号処理を実行でき、金融機関やCA等で標準的なアプローチです。単純なファイル保存やデータベース保存は暗号化外漏の危険があります。"
    },
    {
      "id": "sa_security_003",
      "question": "SSL/TLSプロトコルを用いた通信の暗号化設計において、完全前方秘匿性（Perfect Forward Secrecy）を実現するための条件として適切なものはどれか。",
      "choices": [
        "RSA暗号化アルゴリズムを使用してセッション鍵を交換する",
        "楕円曲線ディフィ・ヘルマン鍵交換を使用し、セッション毎に一時的な鍵を生成する",
        "TLSハンドシェイク時にサーバー証明書の有効期限を長期設定する",
        "クライアント認証にX.509証明書を使用し、相互認証を強制する"
      ],
      "answer": 1,
      "explanation": "PFS（完全前方秘匿性）は、現在のセッション鍵が漏洩しても過去のセッションの復号を困難にします。これを実現するには、DHE（Diffie-Hellman Ephemeral）やECDHE（楕円曲線版）など一時的鍵交換を使用する必要があります。RSAのみではセッション鍵が静的なサーバー秘密鍵を用いるため、前方秘匿性が提供されません。"
    },
    {
      "id": "sa_security_004",
      "question": "エンタープライズシステムにおいて、ディザスタリカバリ（DR）の設計要件として、RPO（目標復旧時点）が最も影響を受けるのはどれか。",
      "choices": [
        "バックアップファイルのサイズと保管場所",
        "データの同期戦略とレプリケーション機構の設計",
        "復旧対象システムの物理的な地理的距離",
        "DRサイトのネットワーク帯域幅のみ"
      ],
      "answer": 1,
      "explanation": "RPO（Recovery Point Objective：目標復旧時点）は『災害発生時にどこまで遡ってデータを復旧するか』を定義します。RPOが厳しい場合（例：数時間以内）には、リアルタイム同期やレプリケーション、高頻度スナップショットなどの多くの仕組みが必要になります。これはバックアップ戦略、データベーストランザクションログ、非同期レプリケーション等に直接影響します。"
    },
    {
      "id": "sa_security_005",
      "question": "マイクロサービスアーキテクチャにおけるサービス間通信のセキュリティ設計として、mTLS（相互TLS）を導入する主な目的として正しいものはどれか。",
      "choices": [
        "クライアント側のみの一方向認証を確立する",
        "各マイクロサービスが互いに真正性を検証し、通信チャネルを暗号化する",
        "APIゲートウェイを経由しないダイレクト通信の禁止",
        "コンテナレジストリへのアクセス制御を強化する"
      ],
      "answer": 1,
      "explanation": "mTLS（Mutual TLS）はサーバーとクライアントが互いに証明書で認証します。マイクロサービス環境では、サービス間の通信も信頼できないとみなし、各サービスペアで相互認証・暗号化を実施することで、内部ネットワークの脅威から保護できます。Istioなどのサービスメッシュでこれを自動化されることが多いです。"
    },
    {
      "id": "sa_security_006",
      "question": "多要素認証（MFA）の設計において、セッション盗聴攻撃を最小化するために考慮すべき要素として最も適切なものはどれか。",
      "choices": [
        "パスワードの複雑さ要件をさらに厳しくする",
        "フィッシング対策として、FIDO2やハードウェアセキュリティキーの導入を検討する",
        "SMS認証のみを使用して実装コストを削減する",
        "認証頻度を制限し、一度認証されたら長期トークンを発行する"
      ],
      "answer": 1,
      "explanation": "フィッシングやセッション盗聴に強いのはFIDO2（Fast Identity Online 2）やハードウェアセキュリティキー（セキュリティキー）です。これらはフィッシングサイトに対して自動的に認証を拒否する仕組みになっており、SMS認証より格段に安全です。一方、SMS認証はSIMスワップ攻撃に弱く、長期トークンはセッション固定攻撃に脆弱です。"
    },
    {
      "id": "sa_security_007",
      "question": "データ保護規制（例：GDPR）への準拠が必要なシステム設計において、個人情報の『削除権（Right to Erasure）』を実装するうえでの課題として最も重要なものはどれか。",
      "choices": [
        "すべてのバックアップとレプリケーションからも個人情報を完全に削除する仕組み",
        "インデックスとキャッシュの再構築のみで十分である",
        "削除要求の処理は即座に完了する必要があり、一時的な遅延は許容される",
        "他システムとの連携がないシステムであれば、主システムの削除のみで十分"
      ],
      "answer": 0,
      "explanation": "GDPRの削除権はオンラインシステムだけでなく、バックアップ、アーカイブ、レプリケーション、ログなど、あらゆる箇所からの削除を要求します。これはシステム設計段階で『削除可能な社内設計』を考慮する必要があり、単なる論理削除では不十分です。特に業務ログやコンプライアンス目的のアーカイブから削除するのは設計の課題となります。"
    },
    {
      "id": "sa_security_008",
      "question": "クラウドストレージ上での顧客データの暗号化戦略として、『カスタマーマネージド暗号化キー（CMEK）』を導入するメリットとして最も適切なものはどれか。",
      "choices": [
        "暗号化処理のパフォーマンスが向上し、レイテンシが低減される",
        "キー管理責任をクラウドプロバイダに完全に委譲でき、管理負荷がなくなる",
        "お客様側でキーのライフサイクル管理を完全制御でき、プロバイダ側でも復号できない状態にできる",
        "すべてのストレージサービスで無制限の無料利用が可能になる"
      ],
      "answer": 2,
      "explanation": "CMEK（Customer-Managed Encryption Keys）ではお客様がキーを管理し、クラウドプロバイダはメタデータのみ保有します。これにより、プロバイダやプロバイダ従業員によるデータアクセスを物理的に防ぐことができ、『お客様だけがデータにアクセス可能』な状態を実現します。多くの規制（HIPAA、GDPR等）ではこのレベルの制御が推奨・要求されます。"
    },
    {
      "id": "sa_security_009",
      "question": "ネットワークセグメンテーション設計において、マイクロセグメンテーションを導入する主な目的として最も適切なものはどれか。",
      "choices": [
        "ネットワーク内の全トラフィックを暗号化し、通信内容を秘密にする",
        "ネットワーク境界におけるファイアウォール設定を簡潔化する",
        "デバイスやサービス間の通信を最小権限原則で制御し、横展開攻撃を防止する",
        "IPアドレス競合を避けるためのサブネット分割"
      ],
      "answer": 2,
      "explanation": "マイクロセグメンテーションは『従来のセグメント（部門別など）ではなく、個別のデバイス・ワークロード・ユーザーレベルで通信を制限』する設計です。これにより、ある端末が侵害されても、他の端末への横展開を防止できます。ゼロトラストアーキテクチャの基本要素でもあり、SDN（ソフトウェア定義ネットワーク）やNACの技術を用いて実装します。"
    },
    {
      "id": "sa_security_010",
      "question": "API設計においてレート制限（Rate Limiting）を実装する目的として、セキュリティ観点から最も重要なものはどれか。",
      "choices": [
        "エンドポイントの処理負荷を均等に分散し、レスポンスタイムを改善する",
        "DDoS攻撃やブルートフォース攻撃による過度な要求を制限し、サービス可用性を守る",
        "クライアント側のバッファオーバーフローを防止する",
        "APIドキュメンテーションのアクセス頻度を制限する"
      ],
      "answer": 1,
      "explanation": "レート制限は同一クライアントからの短時間での過度な要求を拒否することで、DDoS攻撃やパスワードブルートフォース攻撃、リソース枯渇攻撃を緩和します。これはセキュリティと可用性の両面から重要です。実装方法としてはトークンバケットアルゴリズムやスライディングウィンドウが用いられます。"
    },
    {
      "id": "sa_security_011",
      "question": "エンタープライズシステムのRTO（目標復旧時間）を1時間以内とする設計方針として、採用すべきアプローチはどれか。",
      "choices": [
        "月1回の定期バックアップと、バックアップからの復旧手順書の作成",
        "複数のアクティブデータセンターでアクティブ・アクティブレプリケーションを行い、自動フェイルオーバー機構を構築する",
        "スタンバイデータセンターにデータを非同期レプリケーションし、障害時に手動でスイッチオーバーする",
        "システムのバージョン管理ツールの履歴から復旧することで対応する"
      ],
      "answer": 1,
      "explanation": "RTO1時間以内は非常にシビアな要件で、手動復旧では達成困難です。アクティブ・アクティブ構成でも同じデータセンターに障害が及ぶ場合があるため、地理的に分散した複数データセンターでの自動フェイルオーバーが必須です。これにより、ダウンタイムを数分～数秒に抑えられます。非同期レプリケーション＋手動スイッチオーバーではRTO数十分～数時間かかります。"
    },
    {
      "id": "sa_security_012",
      "question": "キー管理サービス（KMS）を利用して暗号キーのローテーションを自動化する際の設計ポイントとして、最も重要なものはどれか。",
      "choices": [
        "旧キーで暗号化されたデータの復号能力を保持しながら、新キーで新規データを暗号化する",
        "ローテーション時に旧キーで暗号化されたデータはすべて削除する",
        "キーのローテーション頻度を極力少なくして、パフォーマンス負荷を減らす",
        "カスタマーマネージド暗号化では、キー管理サービスの利用を避けるべき"
      ],
      "answer": 0,
      "explanation": "キーローテーション設計では『透過的移行』が重要です。旧キーは削除せず、復号用にのみ保持し、新キーで新規データを暗号化します。フルローテーション（すべてのデータを再暗号化）を実施する場合でも、既存データへのアクセスに支障がないよう計画する必要があります。AWS KMS、Azure Key Vault等ではこれを自動化する機能があります。"
    },
    {
      "id": "sa_security_013",
      "question": "クラウド環境におけるIAM（Identity and Access Management）の設計において、権限の最小権限原則を実装するための具体的アプローチとして最も効果的なものはどれか。",
      "choices": [
        "すべてのユーザーに『管理者』権限を付与し、個別制御は行わない",
        "ロールベースアクセス制御（RBAC）により職務ごとに最小限の権限を付与し、定期的に権限棚卸しを実施する",
        "ユーザー単位で個別にポリシーを作成し、きめ細かく制御する",
        "ローカルアカウントのみを使用し、クラウドネイティブなIDサービスは使用しない"
      ],
      "answer": 1,
      "explanation": "RBACは職務（Role）単位で権限グループを定義し、ユーザーロールを付与する方式です。最小権限原則では『その職務に必要な最小限の権限のみ』をロールに含めます。加えて、定期的な権限棚卸し（アクセスレビュー）により、不要になった権限の削除を実施します。これはスケーラブルで監査しやすい設計です。"
    },
    {
      "id": "sa_security_014",
      "question": "オンプレミスシステムとクラウド環境を統合したハイブリッド構成において、セキュリティゾーン間の通信を保護するための標準的な技術はどれか。",
      "choices": [
        "HTTPSによるWebトラフィック暗号化のみで十分",
        "プライベートVPN（仮想プライベートネットワーク）を構築し、エンドツーエンド暗号化通信を実現する",
        "公開インターネットを経由した平文通信は避け、専用線を引く場合のみ非暗号化でよい",
        "ファイアウォールルールのみで十分であり、暗号化は不要"
      ],
      "answer": 1,
      "explanation": "ハイブリッド環境ではオンプレミスとクラウド間の通信が公開インターネット経由になる場合が多く、その場合VPNでエンドツーエンド暗号化を行います。実装としてはIKEv2/IPSecやWireGuard、TLS/SSL VPNなどが利用されます。これにより中間者攻撃やパケットスニッフィングを防止できます。"
    },
    {
      "id": "sa_security_015",
      "question": "セキュリティイベント検知・対応（SIEM）システムの導入において、ログ集約の主な目的として最も適切なものはどれか。",
      "choices": [
        "システムパフォーマンスを向上させるため、ログ出力を削減する",
        "異なるシステムからの複数のログソースを統一的に分析し、セキュリティインシデントの兆候を検知・調査する",
        "コンプライアンス要件を満たすため、ログを一箇所に集めるだけ",
        "紙への出力コストを削減するため、デジタル化する"
      ],
      "answer": 1,
      "explanation": "SIEMはサーバー、ファイアウォール、IDS/IPS、アプリケーション等の多数のシステムからログを集約し、相関分析により異常を検知します。単独ログでは検知困難な攻撃パターン（例：複数失敗ログインの後、異常なファイルアクセス）も検知できます。これはインシデント対応時間を短縮し、セキュリティ脅威への迅速な対応を可能にします。"
    },
    {
      "id": "sa_security_016",
      "question": "APT（Advanced Persistent Threat）による侵害の可能性に備えるための設計アプローチとして、最も適切なものはどれか。",
      "choices": [
        "ファイアウォールの強化のみで対抗できる",
        "検知を主眼とした防御設計（Detect & Respond）により、侵害を早期に検知し迅速に対応する体制を整える",
        "すべての脅威をブロックすることは不可能であるため、セキュリティ対策は不要",
        "定期的なセキュリティパッチのみで十分"
      ],
      "answer": 1,
      "explanation": "APTは高度な攻撃手法で、従来の防御を突破する可能性があります。そのため、『検知と対応』を重視した設計が推奨されます。これはネットワーク異常検知（NDR）、エンドポイント検知対応（EDR）、脅威インテリジェンス等の多層防御により、侵害を早期に発見し、被害を最小化することを目指すアプローチです。"
    },
    {
      "id": "sa_security_017",
      "question": "コンテナイメージのセキュリティ検査をビルドパイプラインに統合する際の重点項目として最も重要なものはどれか。",
      "choices": [
        "イメージサイズを最小化すること",
        "既知の脆弱性（CVE）を検出し、デプロイ前に修復する仕組み",
        "ログ出力レベルを最大化すること",
        "コンテナハブへの登録数を増やすこと"
      ],
      "answer": 1,
      "explanation": "コンテナイメージには古いライブラリやOSパッケージが含まれ、既知の脆弱性を持つ場合があります。ビルドパイプラインにTrivy、Anchore、Aquaなどのスキャンツールを統合し、CVEを自動検出・ブロックすることで、脆弱なイメージのデプロイを防止できます。これはDevSecOpsの基本実践です。"
    },
    {
      "id": "sa_security_018",
      "question": "Kubernetes環境におけるネットワークセキュリティの設計として、NetworkPolicyを導入する目的として最も適切なものはどれか。",
      "choices": [
        "Podのリソース利用量を制限する",
        "Podレベルでのインバウンド・アウトバウンド通信を制御し、マイクロセグメンテーションを実現する",
        "コンテナイメージの脆弱性をスキャンする",
        "ノード間のネットワーク遅延を最適化する"
      ],
      "answer": 1,
      "explanation": "Kubernetes NetworkPolicyはファイアウォールルールのように機能し、Pod単位での通信制御が可能です。デフォルトで全トラフィックを拒否し、必要な通信のみを許可するDeny-allアプローチにより、Kubernetes環境内でのマイクロセグメンテーションを実現できます。これはコンテナ逃脱やPod間の横展開を防止します。"
    },
    {
      "id": "sa_security_019",
      "question": "API利用時の認可を実装する際に、OAuth 2.0と比較したOpenID Connectの追加価値として最も適切なものはどれか。",
      "choices": [
        "よりシンプルな実装で直接的にアクセストークンを発行する",
        "ユーザーの身元認証（Authentication）情報とプロフィール情報をIDトークンで提供する",
        "API呼び出し数を制限する機能がある",
        "HTTPSの要件が緩和される"
      ],
      "answer": 1,
      "explanation": "OAuth 2.0は認可（Authorization：『何ができるか』）のみを扱います。OpenID ConnectはOAuth 2.0の上に認証層（Authentication：『本人確認』）を追加し、IDトークンを以てユーザーの身元情報を提供します。ソーシャルログイン実装時にはOpenID Connectを使う場合が多いです。"
    },
    {
      "id": "sa_security_020",
      "question": "SQLインジェクション脆弱性を完全に防止するための設計アプローチとして、最も有効なものはどれか。",
      "choices": [
        "ユーザー入力値に対して、一般的な記号をすべてフィルタリングする",
        "プリペアドステートメント（パラメータ化クエリ）を使用し、SQL構文と入力値を分離する",
        "複雑なパスワード要件を強制する",
        "SSL/TLSによる暗号化通信で対応できる"
      ],
      "answer": 1,
      "explanation": "SQLインジェクションは、ユーザー入力をSQL構文として解釈させる攻撃です。プリペアドステートメントではドライバレベルでSQL構文が確定してから入力値をバインドするため、入力値がSQLコマンドとして実行される余地がありません。これは根本的・確実な対策です。フィルタリングはバイパス手法が存在し、効果的ではありません。"
    },
    {
      "id": "sa_security_021",
      "question": "ビジネス継続計画（BCP）の策定において、優先度分析（BIA）で決定すべき重要な指標として最も関連性が高いのはどれか。",
      "choices": [
        "ユーザー数とシステムの物理サイズ",
        "ビジネスプロセスの重要度、依存関係、RTO・RPO要件",
        "使用しているデータベース製品の価格",
        "従業員の技術スキルレベル"
      ],
      "answer": 1,
      "explanation": "BIA（Business Impact Analysis）はビジネスプロセスが停止した場合の影響を分析し、復旧優先度とRTO・RPO要件を決定します。これを基に、優先度の高いシステムには複数拠点構成やリアルタイムレプリケーション等、厳しいRTO・RPOを達成する仕組みを構築します。重要度分析なしのBCP策定は、実効性が低くなります。"
    },
    {
      "id": "sa_security_022",
      "question": "情報セキュリティ侵害時の対応体制（インシデント管理）として、最初に実施すべきプロセスはどれか。",
      "choices": [
        "直ちに管理者権限でシステムをシャットダウンする",
        "侵害の報告・通知プロセスに従い、関係部門に報告し、初動調査チームを編成する",
        "犯人の特定と法的訴追を最優先にする",
        "メディア・顧客への公表を直ちに実施する"
      ],
      "answer": 1,
      "explanation": "インシデント管理の最初のステップは『Detect & Report』です。侵害の兆候を検知したら、内部の報告ラインに従い関係部門に通知し、初動調査チームを編成します。この段階での慌てたシステムシャットダウンやメディア発表は、証拠滅失や混乱を招きます。NIST Cybersecurity Framework等で推奨される段階的対応を実施します。"
    },
    {
      "id": "sa_security_023",
      "question": "フォレンジック調査能力を備えたシステム設計において、事後の調査効率を高めるために設計段階で実施すべき対策として最も重要なものはどれか。",
      "choices": [
        "全トラフィック負荷の記録により、ネットワークパケット保存期間を極力短くする",
        "監査ログの完全性を保証し、改ざん防止機構を備えた保管方式を設計する",
        "フォレンジック調査用のテスト環境を、本番環境と全く同じ構成にする",
        "管理者がログにアクセスしやすいよう、パスワード保護を外す"
      ],
      "answer": 1,
      "explanation": "フォレンジック調査の鍵是『ログの信頼性』です。監査ログはWAFロック（Write Once Read Many）、改ざん検知機構（ハッシュチェーンなど）、タイムスタンプサービスにより、改ざん防止を図ります。これにより、訴訟での証拠能力を備えたログとなります。ログ保存期間は法的要件や運用方針で定めるべきです。"
    },
    {
      "id": "sa_security_024",
      "question": "クラウド上のセンシティブデータ（個人情報・営業秘密等）の保護として、エンドツーエンド暗号化を実装する際の設計課題として最も重要なものはどれか。",
      "choices": [
        "暗号化アルゴリズムの処理性能を最大化すること",
        "クライアント側で暗号化し、暗号化された状態でクラウドに保管・転送するが、検索やデータ処理の機能制限になる可能性がある",
        "暗号化鍵をクラウドプロバイダに保管させ、プロバイダのシステムで復号を行う",
        "暗号化はクライアント側で装置を用いず、応用層でのみ実装する"
      ],
      "answer": 1,
      "explanation": "エンドツーエンド暗号化（E2EE）はデータを最初から最後まで暗号化した状態で扱うため、セキュリティレベルは最高ですが、クラウド側での検索・インデックス・分析等の機能が制限されます。これが実装上の課題となり、『暗号化検索可能スキーム（Searchable Encryption）』等の新技術が研究されています。実装時は機能とセキュリティのバランスを考慮する必要があります。"
    },
    {
      "id": "sa_security_025",
      "question": "脆弱性情報（CVE）への対応プロセスにおいて、パッチ適用の優先度を決定する際の最適な方法はどれか。",
      "choices": [
        "CVEスコア（CVSS）の値が高い順に、すべてのシステムに一括適用する",
        "組織資産の重要度、脆弱性の悪用可能性、システムへの実装状況等を総合評価し、リスクベースで優先度を決定する",
        "新しいCVEから順に対応し、古いCVEは後回しにする",
        "パッチが公開されたら、検証なしで直ちに本番環境に適用する"
      ],
      "answer": 1,
      "explanation": "パッチマネジメントはリスクベースで実施します。CVSSスコアが高くても、攻撃が実現不可能（例：物理アクセス要）な場合や、関連するシステムがない場合は優先度が低い場合があります。逆に、スコアは中程度でも、インターネット公開システムの脆弱性は優先的に対応すべきです。この判断にはリスク分析が不可欠です。"
    },
    {
      "id": "sa_security_026",
      "question": "Webアプリケーションファイアウォール（WAF）を導入する際の設計上の留意点として最も適切なものはどれか。",
      "choices": [
        "すべてのHTTPリクエストをブロックし、指定ホワイトリスト以外のアクセスは許可しない",
        "一般的な攻撃パターン（SQLインジェクション、クロスサイトスクリプティング等）を検知・ブロックしつつ、正規ユーザートラフィックへの影響を最小化する",
        "WAFのあり・なしで性能差がないよう設計する",
        "ログ記録は無効化し、パフォーマンスを優先する"
      ],
      "answer": 1,
      "explanation": "WAFはシグネチャベースまたはアノマリベースで攻撃を検知しますが、過剰なブロックは『誤検知』となり、正規ユーザーの利便性を損ないます。チューニングによりfalse positive/negativeのバランスを取り、同時にログ記録により検知・検証可能な体制を構築することが重要です。ModSecurityやCloudflare WAFが代表的な選択肢です。"
    },
    {
      "id": "sa_security_027",
      "question": "リネーム（侵害後の追跡困難化）が困難な大規模分散システムの設計において、セキュリティの可視性を高めるための技術として最も適切なものはどれか。",
      "choices": [
        "ローカルログのみで対応し、外部への送信は避ける",
        "SIEM と EDR を組み合わせ、集約化されたログと行動検知により、システム全体の異常を監視する",
        "インターネット遮断により外部通信を遮断する",
        "ユーザーのログイン記録のみ追跡する"
      ],
      "answer": 1,
      "explanation": "大規模分散システムでの侵害検知にはSIEM（ログ集約・相関分析）とEDR（エンドポイント行動検知）の組み合わせが効果的です。SIEM でネットワークレベルの異常を、EDR でホストレベルの不正プロセス実行を検知することで、単独では検知困難な洗練された攻撃にも対応できます。"
    },
    {
      "id": "sa_security_028",
      "question": "技術的債務の観点からセキュリティ設計を考慮する際の最良の実践として適切なものはどれか。",
      "choices": [
        "セキュリティ実装の遅延を許容し、後で一括実装することで工数削減する",
        "初期実装段階からセキュティアーキテクチャを設計に組み込み、脆弱な設計への修正コストを最小化する",
        "セキュリティは製品リリース後の対応で十分",
        "セキュリティと機能実装は独立したワークストリームとして扱う"
      ],
      "answer": 1,
      "explanation": "セキュリティを後付けすると、アーキテクチャ全体の修正が必要になり、修正コストは設計段階での実装の数倍以上になります。これが『セキュリティ技術債』です。初期段階からセキュアバイデザイン原則に基づいて設計することで、長期的なコスト削減と品質向上が実現します。"
    },
    {
      "id": "sa_security_029",
      "question": "APIゲートウェイの設計において、率制限（Throttling）以外のセキュリティ機能として最も重要なものはどれか。",
      "choices": [
        "APIバージョンの自動更新機能",
        "認証・認可、入力検証、ログ記録、WAF機能の統合",
        "キャッシュサイズの最適化",
        "データベース接続プーリング"
      ],
      "answer": 1,
      "explanation": "APIゲートウェイはシステムの『玄関口』として、認証スキーム（OAuth、SAML等）の検証、認可ポリシーの実装、不正なペイロードの検出・拒否、すべてのAPI呼び出しのログ記録等の機能を集約します。AWS API Gateway、Kong、Istioゲートウェイなどで実装されます。"
    },
    {
      "id": "sa_security_030",
      "question": "システム間連携の認証において、サービス・プリンシパルを使用するメリットとして最も適切なものはどれか。",
      "choices": [
        "ユーザーアカウントと同じセキュリティ強度を実現できる",
        "アプリケーション/サービスが相互に認証される人間の手を介さない自動化が可能になり、パスワード共有を避けられる",
        "管理者権限が自動的に付与される",
        "ネットワークセグメンテーションが不要になる"
      ],
      "answer": 1,
      "explanation": "サービス・プリンシパル（Service Principal）は Azure や Kubernetes で、非ユーザーエンティティ（主にマイクロサービス）が認証・認可される仕組みです。人間を介さず自動化を実現し、パスワード共有による脆弱性を排除します。最小権限原則に沿った権限付与も容易です。"
    },
    {
      "id": "sa_security_031",
      "question": "データベースの暗号化戦略において、『保存時の暗号化（Encryption at Rest）』と『転送中の暗号化（Encryption in Transit）』を組み合わせる目的として最も適切なものはどれか。",
      "choices": [
        "データベースのサイズを削減するため",
        "保存時は物理盗難からの保護を、転送中はネットワーク盗聴からの保護を実現する",
        "両方を実装することで、パフォーマンスが向上する",
        "法的要件はないが、行うべきベストプラクティス"
      ],
      "answer": 1,
      "explanation": "暗号化の層別化は『多層防御』です。保存時の暗号化（DBE、TDE等）は物理ディスクへのアクセスからの保護、転送中の暗号化（TLS/SSL）はネットワーク盗聴からの保護を提供します。両方を実装することで、全ライフサイクルでのデータ保護が実現できます。"
    },
    {
      "id": "sa_security_032",
      "question": "ユーザー認証後のセッション管理設計において、セッションハイジャック攻撃を防止するための対策として最も有効なものはどれか。",
      "choices": [
        "セッションID を URL に埋め込み、アクセス毎に新規生成する",
        "HTTPのみの通信を使用し、HTTPS化は避ける",
        "セッションクッキーに Secure・HttpOnly・SameSite 属性を設定し、暗号化通信（HTTPS）で送受信する",
        "セッションID の有効期限を無限に設定し、ユーザーが明示的にログアウトするまで維持"
      ],
      "answer": 2,
      "explanation": "セッションハイジャック対策は、クッキーの盗聴・盗用を防ぐことが重要です。HttpOnly 属性でJavaScript からのアクセスを禁止（XSS 対策）、Secure 属性で HTTPS のみ送信、SameSite 属性でCSRF 対策を実施します。同時に HTTPS による通信暗号化で、ネットワークレベルの盗聴も防止します。"
    },
    {
      "id": "sa_security_033",
      "question": "マルチクラウド環境でのセキュリティポスチャー管理（CSPM）の導入目的として最も適切なものはどれか。",
      "choices": [
        "複数クラウドプロバイダの請求コストを一元管理する",
        "複数のクラウド環境におけるセキュリティ設定の誤り、コンプライアンス違反を自動検出・修復する",
        "全クラウドプロバイダで同一のパスワードポリシーを強制する",
        "ネットワーク遅延を最小化する"
      ],
      "answer": 1,
      "explanation": "CSPM（Cloud Security Posture Management）はAWS、Azure、GCP等の複数クラウドやオンプレミスを統一的に監視し、セキュリティ設定よれをスキャン、コンプライアンス（CIS Benchmarks等）違反を検出、自動修復を実行します。Wiz、Lacework、Paloalto Networks Prisma Cloud等が代表的です。"
    },
    {
      "id": "sa_security_034",
      "question": "ソフトウェア開発ライフサイクル（SDLC）にセキュリティを統合したセキュアSDLC（S-SDLC）設計の最大のメリットとして最も適切なものはどれか。",
      "choices": [
        "開発期間を短縮できる",
        "製品リリース後の脆弱性発見時の修正コスト削減と、より安全な製品をリリースできる",
        "テストチーム不要になる",
        "セキュリティ人材の採用が不要になる"
      ],
      "answer": 1,
      "explanation": "S-SDLCは要件定義、設計、実装、テスト、デプロイの各段階にセキュリティレビューと検査を組込みます。初期段階での脆弱性検出により、後段階での修正コストを削減でき、リリース後のセキュリティインシデント対応も削減できます。NIST等でセキュアな開発の必須プラクティスとされています。"
    },
    {
      "id": "sa_security_035",
      "question": "従業員による意図的・無意図的なデータ漏洩を防止するためのDLP（Data Loss Prevention）の実装方針として最も適切なものはどれか。",
      "choices": [
        "メール・USB・クラウドストレージへのアクセスをすべて禁止する",
        "センシティブデータの分類、アクセス制御、異常検知、ポリシー教育を組み合わせて実装する",
        "社員を厳しく監視し、すべての操作を記録・制限する",
        "DLP 導入により漏洩リスクはゼロになる"
      ],
      "answer": 1,
      "explanation": "効果的なDLP はセキュリティと利便性のバランスです。データを分類し(Public/Internal/Confidential等)、分類レベル毎に転送先を制御し、ユーザー教育で意図的漏洩を防止し、EDRで異常な データ移動を検知します。過度な制限はシャドー IT につながり逆効果です。"
    },
    {
      "id": "sa_security_036",
      "question": "高可用性設計において、ロードバランサーの障害に対する対策として最も実用的なものはどれか。",
      "choices": [
        "ロードバランサーを複数冗長配置し、正常性監視・自動フェイルオーバーを導入する",
        "ロードバランサーは単一構成で十分であり、サーバー側の冗長化のみで対応する",
        "ロードバランサーの定期メンテナンスを頻繁に実施する",
        "全トラフィックをロードバランサーを経由せず、ダイレクトに分散する"
      ],
      "answer": 0,
      "explanation": "ロードバランサー自体が単一故障点（SPOF）になります。複数のロードバランサーをアクティブ・アクティブまたはアクティブ・スタンバイで配置し、ヘルスチェック・自動フェイルオーバーを設定することで、ロードバランサー障害時のダウンタイムを排除できます。AWS ALB、NGINX Plus等で実装されます。"
    },
    {
      "id": "sa_security_037",
      "question": "ボットネット感染に対する防御設計として、エンドポイントセキュリティの観点から最も重要なものはどれか。",
      "choices": [
        "定期的なシステム再起動のみで予防できる",
        "エンドポイント検知対応（EDR）により、不審なネットワーク接続・プロセス実行を検知し、即座に隔離する",
        "アンチウイルスソフトの定義ファイル更新のみで十分",
        "ボットネット感染は避けられないため、対策は不要"
      ],
      "answer": 1,
      "explanation": "ボットネットは『感染+通信』の組み合わせで動作します。EDRは既知マルウェアのシグネチャ検知に加え、異常な外部通信や暗号化通信等の行動を検知します。コマンドアンドコントロール（C2）サーバーへの接続を早期に遮断できるため、ボットネット運用者への参加を防止できます。"
    },
    {
      "id": "sa_security_038",
      "question": "システム可用性99.99%（ダウンタイム年間約52分）を実現するための設計方針について、最も現実的なものはどれか。",
      "choices": [
        "単一データセンター構成で、定期メンテナンス以外は完全な無停止を実現する",
        "複数の物理サイトでアクティブ・アクティブ構成を組み、自動フェイルオーバー・ローリング更新等を実装する",
        "費用を考慮せず、完全冗長化により99.999%以上を目指す",
        "ダウンタイム許容度の設定は不要で、常に最大可用性を目指す"
      ],
      "answer": 1,
      "explanation": "99.99%可用性（four nines）を安定的に実現するには、複数サイト構成とアクティブ・アクティブ構成が必須です。単一サイトではメンテナンスやハードウェア交換で必ずダウンタイムが発生します。ローリング更新、負荷分散、自動フェイルオーバーにより、計画・計画外停止を最小化できます。"
    },
    {
      "id": "sa_security_039",
      "question": "クラウド環境でのインシデント対応体制の設計において、フォレンジック能力を維持するために最も重要な設計要素はどれか。",
      "choices": [
        "インスタンスをシャットダウンし、データを物理的に取得する",
        "API呼び出しログ、VPC フローログ、アプリケーションログを集約し、改ざん防止機構付き長期保管を実施する",
        "クラウドプロバイダのログサービスのみに頼り、追加の監視を実装しない",
        "不定期なログ削除は避け、無限に保管する"
      ],
      "answer": 1,
      "explanation": "クラウド環境ではインスタンスを即座に削除・修復されることがあり、後からのフォレンジックが困難になります。そのため、API ログ（CloudTrail等）、ネットワークログ（VPC Flow Logs）、アプリケーションログを外部ストレージ（S3等）に中央集約し、改ざん防止（WORM）・暗号化により長期保管して、後からの調査に備えます。"
    },
    {
      "id": "sa_security_040",
      "question": "サプライチェーン攻撃への対策として、ソフトウェア部品（SCA）管理の観点から最も重要な設計要素はどれか。",
      "choices": [
        "外部オープンソースライブラリの使用を完全に禁止する",
        "使用するライブラリの脆弱性監視、バージョン管理、ライセンス確認を一元化し、悪意あるバージョン・コンポーネント導入を防止する",
        "開発環境と本番環境で異なるバージョンを使い分ける",
        "npm、Maven等のパッケージマネージャの使用を避ける"
      ],
      "answer": 1,
      "explanation": "SCA（Software Composition Analysis）はオープンソースを含むソフトウェア部品の脆弱性を継続的に監視し、既知CVEの導入を防止します。加えて、ライセンス確認でコンプライアンスを確保し、ビルドパイプラインに統合することで、悪意あるパッケージの混入やサプライチェーン汚染を防止します。SBOM（Software Bill of Materials）作成もプラクティスです。"
    },
    {
      "id": "sa_security_041",
      "question": "内部ネットワークセキュリティにおいて、『退勤者によるアカウント・アクセス権削除』の遅延が引き起こす最大のリスクとして最適な説明はどれか。",
      "choices": [
        "オフィスの在席人数が正確に把握できない",
        "退勤者が既得権を利用した不正アクセス、データ盗用、システム改ざんを実行される可能性",
        "新入社員のアカウント申請処理に時間がかかる",
        "給与計算システムのエラーが発生する"
      ],
      "answer": 1,
      "explanation": "アクセス権の『遅延削除』は内部脅威の典型的なシナリオです。退勤者が故意に不正アクセス・データ盗用・システム破壊を実行した場合、アクセス権削除遅延により多くの時間を稼げます。プロセスの自動化、HR システムとの連携、定期的なアクセスレビューにより、リスクを最小化する必要があります。"
    },
    {
      "id": "sa_security_042",
      "question": "物理的セキュリティと論理的セキュリティを統合した包括的な設計において、データセンターへの入退出管理として最も重要なものはどれか。",
      "choices": [
        "入退出記録を月1回チェックして対応する",
        "バイオメトリクス認証・入退出ログ記録・多要素認証を組み合わせ、アクセス権限を常に検証する",
        "鍵と知識ベース認証（セキュリティ質問等）のみで十分",
        "管理者と信頼できる社員は、事前申請なしで出入りできる"
      ],
      "answer": 1,
      "explanation": "データセンター物理アクセスは最高レベルの管理が必要です。バイオメトリクス（指紋認証・虹彩認証）により本人確認の確実性を確保し、すべての入退出をログ記録し、定期的に権限見直しを実施します。これにより、内部従業員による盗聴器設置やディスク抜き出しを防止できます。"
    },
    {
      "id": "sa_security_043",
      "question": "供給制約下での代替部品使用時、ハードウェアセキュリティ設計として最も留意すべき要素はどれか。",
      "choices": [
        "代替部品の供給元確認は省略可能",
        "代替部品の供給元正当性確認、ファームウェア完全性検証、ハードウェアセキュリティキー変更を実施する",
        "代替部品は既知の安全性があるため、検証は不要",
        "費用削減を最優先に、最安値の部品を採用する"
      ],
      "answer": 1,
      "explanation": "サプライチェーン攻撃の観点から、供給元不明の代替部品導入は重大なリスクです。正規の代替品提供ルート、改ざん防止パッケージング、正規販売元からの購入を確認する必要があります。加えて、導入後もファームウェア異常や物理改ざんの兆候をテストにより检查します。"
    },
    {
      "id": "sa_security_044",
      "question": "API セキュリティの設計において、OpenAPI（Swagger）仕様の適切な活用方法として最も重要なものはどれか。",
      "choices": [
        "API の機能説明のみに使用し、セキュリティ定義は不要",
        "認証スキーム、レート制限、入力スキーマ検証等をOpenAPI仕様に含め、セキュリティテストに活用する",
        "API開発と仕様管理は独立して運用する",
        "デコレータなしで自動生成され、手動修正は禁止"
      ],
      "answer": 1,
      "explanation": "OpenAPI仕様は単なるドキュメントではなく、セキュリティ定義を含む機械可読フォーマットです。認証ドキュメント（securitySchemes）、入力スキーマ、制限条件を仕様に記載することで、自動テスト・コード生成・セキュリティスキャンに活用できます。API セキュリティテスト（Burp Suite等）でも利用可能です。"
    },
    {
      "id": "sa_security_045",
      "question": "システムのセキュリティ改善において、費用対効果を最優先とした設計判断として最も適切なものはどれか。",
      "choices": [
        "最も費用が安い対策を常に選択する",
        "リスクの大きさ、実装コスト、期待される低減効果を総合評価し、ROI の高い対策から順に実施する",
        "セキュリティに費用をかけることは無駄である",
        "すべてのセキュリティ対策を同時に導入することで最大効果が得られる"
      ],
      "answer": 1,
      "explanation": "セキュリティ決定は『リスク × 実装コスト × 効果』の三角形バランスです。すべての対策ができない現実では、最大リスク（マイナス）に対する実高い対策から段階的に実装する『リスクベース対応』が現実的です。NIST Cybersecurity Framework やISO27035等で推奨されています。"
    },
    {
      "id": "sa_security_046",
      "question": "機械学習（ML）モデルを用いたセキュリティシステムの設計において、最も注意すべき課題として適切なものはどれか。",
      "choices": [
        "ML モデルが漏洩しても、推論ロジックは隠されているため安全である",
        "患者データを含むモデルの逆変換攻撃、訓練データの毒性化、敵対的攻撃への対抗策を設計に組込む必要がある",
        "ML の予測精度が高ければ、セキュリティリスクはない",
        "ML モデルは定期的な再学習が不要"
      ],
      "answer": 1,
      "explanation": "ML セキュリティは『モデル攻撃』という新しい脅威領域です。逆学習（訓練データ復元）、ポイズニング攻撃（学習データ改ざん）、敵対的サンプル（分類誤り）等が存在します。特にセキュリティ分類タスクでは、攻撃者も ML モデル学習に協力するため、継続的な防御体制が必須です。"
    },
    {
      "id": "sa_security_047",
      "question": "ゾーニング設計によるネットワークセキュリティの実装において、『非武装地帯（DMZ）』の概念として最も正確な説明はどれか。",
      "choices": [
        "完全に安全なネットワークエリアで、外部との通信は一切できない",
        "インターネットと内部ネットワークの間に位置し、Webサーバー等外部公開サービスを配置し、境界で通信制御を実施するエリア",
        "すべてのセキュリティ対策の中心となる特別なサーバー群",
        "内部ネットワークと異なるセキュリティスキャンは不要なエリア"
      ],
      "answer": 1,
      "explanation": "DMZ（demilitarized zone）はセグメンテーションの重要な境界です。インターネット直結を避け、DMZ に Web/メールサーバー等を配置し、DMZ～内部ネットワーク間は厳密なファイアウォール制御を実施します。これにより、DMZ 侵害時の内部への波及を防ぎます。  日本金融機関は『ファイアウォール配下の非武装地帯』を要件とします。"
    },
    {
      "id": "sa_security_048",
      "question": "サイバー保険の導入を視野に入れたセキュリティ設計として、最も重要な準備は何か。",
      "choices": [
        "保険契約後はセキュリティ対策を緩和してもよい",
        "インシデント時の報告手続き、証拠保全、損害算定根拠（監査ログなど）を事前に設計・準備する",
        "保険加入により、セキュリティリスクはすべて転嫁される",
        "サイバー保険は高額であるため、導入は避けるべき"
      ],
      "answer": 1,
      "explanation": "サイバー保険は『リスク転嫁』の手段ですが、保険金請求には根拠証明が必須です。インシデント発生時に『何が起きたか』『損害はどの程度か』を証明するため、事前のログ記録体制、監査証跡の完全性、損害評価基準の設定が重要です。保険カバレッジを最大化するには、セキュリティ対策と保険を統合設計する必要があります。"
    },
    {
      "id": "sa_security_049",
      "question": "グローバル企業におけるデータレジデンシー要件（データ保管場所の制限）への対応設計として最適なアプローチはどれか。",
      "choices": [
        "すべてのデータを単一の中央データセンターに集約し、管理コストを削減する",
        "各国のデータ保護法に基づき、個人情報は当該国・地域内で保管・処理し、必要に応じたデータローカライゼーションを実装する",
        "データレジデンシーはクラウドベンダーが対応すべき課題で、ユーザー企業は関与不要",
        "費用最小化を優先し、最適な保管場所ではなく、コストが安い場所にデータを保管する"
      ],
      "answer": 1,
      "explanation": "GDPR（EEA）、CCPA（カリフォルニア）、中国のデータローカライゼーション等、地域による規制が厳しくなっています。個人情報は当該地域内での保管・処理が要件となり、クロスボーダー転送が制限されます。マルチリージョンcloudやデータセンター配置を設計段階で考慮する必要があります。"
    },
    {
      "id": "sa_security_050",
      "question": "次世代のセキュリティ脅威（例：量子コンピュータによる暗号破解）への体制的な対応として、システム設計段階で最も重要な取り組みはどれか。",
      "choices": [
        "現在の脅威のみに対応し、未来の脅威は想定不要",
        "暗号化アルゴリズムのアジリティを確保し、将来のアルゴリズム移行を容易にする設計、暗号の多元化を検討する",
        "既存システムの即座の全置き換えが必須",
        "量子耐性暗号は成熟していないため、導入は不可能"
      ],
      "answer": 1,
      "explanation": "『暗号の民主化』（Harvest Now Decrypt Later 攻撃）に備え、現在の通信を将来復号されないよう対策が必要です。NIST が耐量子暗号の候補を提案（2024年に標準化予定）しており、システム設計では『暗号アルゴリズムの容易な入れ替え可能性』を考慮すべきです。既存システムも『暗号の多元化』（複数アルゴリズム並行使用）で対応可能です。"
    }
  ]
}
