#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""Generate 50 questions for each SC exam section"""

import json
from datetime import datetime

# SC Technology Section (セキュリティ技術) - 50 questions
sc_technology_questions = {
    "genre": "情報処理安全確保支援士試験",
    "exam": "SC",
    "category": "sc_technology",
    "questions": [
        {
            "id": "sc_tech_001",
            "question": "ゼロトラスト・アーキテクチャの基本原則として最も適切なのはどれか。",
            "choices": ["すべてのユーザーとデバイスを無条件に信頼する", "信頼性なし・常に検証せよ（Trust nothing, verify everything）", "外部ネットワークのみを警戒する", "定期的なセキュリティ監査だけで十分である"],
            "answer": 1,
            "explanation": "ゼロトラスト・アーキテクチャは『信頼性なし・常に検証せよ』が基本原則です。内部・外部を区別せず、すべてのアクセスを検証する必要があります。"
        },
        {
            "id": "sc_tech_002",
            "question": "多層防御（Defense in Depth）を構成する最初の層として最も重要なのはどれか。",
            "choices": ["ファイアウォール", "侵入検知システム", "エンドポイント保護", "暗号化"],
            "answer": 0,
            "explanation": "多層防御の最初の層はネットワーク周辺防御となるファイアウォールです。これが組織の入口での防御を担当します。"
        },
        {
            "id": "sc_tech_003",
            "question": "PKI（認証基盤）において、秘密鍵の管理に最も適したシステムはどれか。",
            "choices": ["サーバのハードディスク上", "HSM（ハードウェアセキュリティモジュール）", "クラウドストレージ", "バックアップSSD"],
            "answer": 1,
            "explanation": "HSMは秘密鍵の保管・処理に特化した専用ハードウェアで、秘密鍵が決してシステム外に出ないため、最も安全です。"
        },
        {
            "id": "sc_tech_004",
            "question": "転送中のデータ保護（Encryption in Transit）におけるPFS（完全前方秘匿性）の主な利点は何か。",
            "choices": ["通信速度の向上", "セッション終了後、過去の通信記録の復号防止", "ストレージのディスク容量削減", "ユーザのパスワード強度向上"],
            "answer": 1,
            "explanation": "PFSにより、セッション秘密鍵が漏えいしても過去の通信は復号できません。これが『完全前方秘匿性』です。"
        },
        {
            "id": "sc_tech_005",
            "question": "データベース暗号化の手法として、TDE（Transparent Data Encryption）の特徴として最も正確なのはどれか。",
            "choices": ["アプリケーション側で暗号化・復号化を実装する", "データベース内部で透過的に暗号化・復号化される", "手動で暗号化キーを管理する必要がある", "読取専用データベースのみ対応"],
            "answer": 1,
            "explanation": "TDEはデータベースシステムが透過的に暗号化・復号化するため、アプリケーション側の変更が不要です。"
        },
        {
            "id": "sc_tech_006",
            "question": "多要素認証（MFA）における、フィッシング攻撃に最も耐性のある方式はどれか。",
            "choices": ["SMS（短いメッセージサービス）コード", "メール送信コード", "FIDO2ハードウェアセキュリティキー", "セキュリティ質問"],
            "answer": 2,
            "explanation": "FIDO2ハードウェアセキュリティキーは、生体認証やPINと物理キーの組み合わせにより、フィッシングに強い認証が可能です。"
        },
        {
            "id": "sc_tech_007",
            "question": "GDPR（一般データ保護規則）の『忘れられる権利』を技術的に実装する際の課題として最も深刻なのはどれか。",
            "choices": ["ユーザのPCのみが対象である", "バックアップから個人データを削除する仕組みの構築", "ファイアウォールの設定変更", "VPN接続の終了"],
            "answer": 1,
            "explanation": "削除要求後も、バックアップやアーカイブからの確実な削除、リカバリポイントからの個人データ除去が技術的課題です。"
        },
        {
            "id": "sc_tech_008",
            "question": "暗号鍵のローテーション戦略において、『透過的な鍵移行』が必要とされる理由は何か。",
            "choices": ["システムのパフォーマンス向上", "サービス停止なしに新しい鍵に移行できる", "セキュリティ監査の簡素化", "バックアップ容量削減"],
            "answer": 1,
            "explanation": "透過的な鍵移行により、ユーザーへのサービス中断なしに定期的なローテーションが可能となります。"
        },
        {
            "id": "sc_tech_009",
            "question": "ネットワークセグメンテーション（マイクロセグメンテーション）の主な目的はどれか。",
            "choices": ["インターネット帯域幅の削減", "横展開攻撃の抑制・最小化", "ユーザの作業効率向上", "ストレージコストの削減"],
            "answer": 1,
            "explanation": "マイクロセグメンテーションにより、侵害されたシステムから他のシステムへの横展開を制限できます。"
        },
        {
            "id": "sc_tech_010",
            "question": "Post-Quantum Cryptography（耐性暗号）に対応するための『暗号アジリティ』とは何か。",
            "choices": ["既存の暗号化と並行して動作可能な設計", "複数の暗号アルゴリズムを柔軟に切り替えられる設計", "暗号化プロセスの高速化", "セキュリティと利便性のバランス"],
            "answer": 1,
            "explanation": "暗号アジリティは、量子コンピュータ脅威への対応として、複数の暗号方式を相互に切り替えられる柔軟性です。"
        },
        {
            "id": "sc_tech_011",
            "question": "CDN（コンテンツデリバリネットワーク）を導入する際のセキュリティ上の注意点として最も重要なのはどれか。",
            "choices": ["CDNサーバのOS更新頻度", "CDN経由のDDoS攻撃検知・対策", "個人データの地理的配置とコンプライアンス", "全て同じ重要度"],
            "answer": 2,
            "explanation": "CDN利用時、個人データが複数国のサーバに分散されるため、データ主権とコンプライアンス遵守が重要です。"
        },
        {
            "id": "sc_tech_012",
            "question": "クラウドストレージの『顧客管理暗号化キー（CMEK）』を使用する主な利点は何か。",
            "choices": ["暗号化処理の高速化", "クラウドプロバイダーが鍵にアクセスできない", "ストレージ容量の増加", "ネットワーク遅延の改善"],
            "answer": 1,
            "explanation": "CMEK使用により、クラウドプロバイダー側が顧客データにアクセスできず、顧客がデータに対する完全な制御を保持します。"
        },
        {
            "id": "sc_tech_013",
            "question": "OAuth 2.0とOpenID Connectの主な違いとして最も適切なのはどれか。",
            "choices": ["OAuth 2.0は認証、OpenID Connectは認可である", "OAuth 2.0は認可、OpenID Connectは認証である", "両者は全く同じプロトコルである", "OpenID Connectはセキュリティが低い"],
            "answer": 1,
            "explanation": "OAuth 2.0は認可（権限許可）、OpenID Connectはそれに認証（本人確認）の層を追加したプロトコルです。"
        },
        {
            "id": "sc_tech_014",
            "question": "相互TLS（mTLS）を導入する目的として最も重要なのはどれか。",
            "choices": ["通信速度の向上", "クライアント・サーバ双方の相互認証", "ユーザインターフェースの改善", "データベース容量の削減"],
            "answer": 1,
            "explanation": "mTLSでは、クライアントがサーバを、サーバがクライアントをそれぞれY证し、サービス間通信の安全性を確保します。"
        },
        {
            "id": "sc_tech_015",
            "question": "APIセキュリティの観点で、Rate Limiting（レート制限）の主な役割は何か。",
            "choices": ["ユーザファイルの暗号化", "DoS/DDoS攻撃の軽減", "ネットワーク遅延の解消", "UIの応答性向上"],
            "answer": 1,
            "explanation": "レート制限は、単位時間あたりのリクエスト数を制御し、DoS/DDoS攻撃による過負荷を抑止します。"
        },
        {
            "id": "sc_tech_016",
            "question": "Webアプリケーションファイアウォール（WAF）の主な機能として最も正確なのはどれか。",
            "choices": ["ネットワークレベルでのすべてのパケット検査", "アプリケーションレベルの攻撃（SQLインジェクション等）検知・遮断", "エンドポイントデバイスの保護のみ", "個人データの自動削除"],
            "answer": 1,
            "explanation": "WAFはアプリケーションレイヤーで動作し、SQLインジェクション、XSS等のWeb攻撃を検知・遮断します。"
        },
        {
            "id": "sc_tech_017",
            "question": "ペネトレーションテスト（ペンテスト）実施前に最も重要な準備は何か。",
            "choices": ["テスター側のセキュリティクリアランス取得", "書面による実施許可・同意書の取得", "テスト専用ネットワークの構築", "全従業員への事前通知"],
            "answer": 1,
            "explanation": "ペンテストは組織の重要なシステムに対する模擬攻撃のため、経営層・法務との書面による明確な合意が必須です。"
        },
        {
            "id": "sc_tech_018",
            "question": "ホワイトボックステスト、グレーボックステスト、ブラックボックステストの中で、最もセキュリティ脅威を網羅的に検出する手法はどれか。",
            "choices": ["ホワイトボックステスト", "グレーボックステスト", "ブラックボックステスト", "いずれも等価な検出能力"],
            "answer": 0,
            "explanation": "ホワイトボックステストは、ソースコード・内部構造を完全に把握した上でテストするため、最も網羅的な脅威検出が可能です。"
        },
        {
            "id": "sc_tech_019",
            "question": "コンテナセキュリティにおいて、イメージスキャンの目的は何か。",
            "choices": ["コンテナの実行速度向上", "既知の脆弱性を含むライブラリの検出", "ユーザアクセスの簡素化", "ディスク領域の削減"],
            "answer": 1,
            "explanation": "イメージスキャンは、コンテナイメージに含まれるベースイメージやライブラリの既知の脆弱性を検出します。"
        },
        {
            "id": "sc_tech_020",
            "question": "マイクロサービスアーキテクチャにおけるサービスメッシュ（Service Mesh）の主な役割は何か。",
            "choices": ["マイクロサービス間の通信管理・暗号化", "CPU負荷の軽減", "ユーザインターフェースの統一", "ストレージの自動バックアップ"],
            "answer": 0,
            "explanation": "Service Meshは、マイクロサービス間のサービス-to-サービス通信を暗号化し、トラフィック管理を実現します。"
        },
        {"id": "sc_tech_021", "question": "エンドツーエンド暗号化（E2EE）が重視される通信形態として最も適切なのはどれか。", "choices": ["社内ネットワーク通信", "機密性の高いメッセージングサービス", "キャッシュCDN配信", "公開Webサイト"], "answer": 1, "explanation": "E2EEは、エンドポイント間以外のすべての中間ノード（プロバイダーを含む）でメッセージを読取不可にします。"},
        {"id": "sc_tech_022", "question": "Secure Boot（セキュアブート）機能の主な目的は何か。", "choices": ["OS起動速度の高速化", "不正な改ざんされたブートローダーの読み込み防止", "ネットワーク接続の最適化", "ユーザデータの自動暗号化"], "answer": 1, "explanation": "Secure Bootは、署名されたブートローダーのみをロードし、起動前のシステム改ざんを検出・防止します。"},
        {"id": "sc_tech_023", "question": "DLP（Data Loss Prevention）ソリューションの主な機能として最も正確なのはどれか。", "choices": ["ネットワークの速度向上", "機密データの無許可送信を検知・遮断", "ユーザのパスワード管理", "バックアップの自動化"], "answer": 1, "explanation": "DLPは、機密データが組織外に流出する前に検知し、遮断する仕組みです。"},
        {"id": "sc_tech_024", "question": "ゼロトラストネットワークにおけるイベントシグナル（Event Signal）として最も重要なのはどれか。", "choices": ["ユーザの勤務時間", "ユーザのデバイスの健全性状態・位置情報・行動パターン", "社員の給与レベル", "建物のセキュリティレベル"], "answer": 1, "explanation": "ゼロトラストでは、デバイス健全性・位置情報・異常な行動など複多くのシグナルを評価して、リアルタイムでアクセス決定します。"},
        {"id": "sc_tech_025", "question": "量子耐性暗号への移行において『Harvest Now, Decrypt Later』攻撃の脅威とは何か。", "choices": ["現在の通信を将来の量子コンピュータで復号される可能性", "セキュリティ監査の手間増加", "ネットワーク速度の低下", "ユーザのプライバシー設定の確認"], "answer": 0, "explanation": "現在の暗号化通信が保存されても、将来の量子コンピュータ出現時に復号される『Harvest Now, Decrypt Later』攻撃への対抗が必要です。"},
        {"id": "sc_tech_026", "question": "VPN（Virtual Private Network）の過度な依存による問題として最も深刻なのはどれか。", "choices": ["通信速度の低下", "単一障害点（SPOF）の形成", "ユーザのプライバシー向上", "バックアップ容量の削減"], "answer": 1, "explanation": "VPN集約による過度な依存は、VPN障害時に全通信が切断される単一障害点を作ります。"},
        {"id": "sc_tech_027", "question": "API Key管理のベストプラクティスとして最も推奨されるのはどれか。", "choices": ["すべてのAPIキーをコード内に記載", "環境変数またはシークレット管理ツールで保管", "共有フォルダに平文保存", "複数人で同一キーを共有"], "answer": 1, "explanation": "APIキーは環境変数またはAWS Secretsなどのシークレット管理ツールで保管し、コードに硬直化（Hard-code）してはいけません。"},
        {"id": "sc_tech_028", "question": "アクセス制御における『最小権限の原則（Principle of Least Privilege）』の実装方法として最も効果的なのはどれか。", "choices": ["すべてのユーザに管理者権限を付与", "業務に必要な最低限の権限のみを付与し、定期的に見直す", "権限を1回だけ確認して以後変更しない", "権限レベルを組織全体で統一"], "answer": 1, "explanation": "最小権限の原則では、ユーザに必要な権限の最小限のみを付与し、定期的に見直して不要な権限を削除します。"},
        {"id": "sc_tech_029", "question": "Privileged Account Management（PAM）ソリューションの主な目的は何か。", "choices": ["ユーザのPCの動作改善", "特権アカウント（管理者）の使用の可視化・制御・監査", "ネットワーク帯域の最適化", "USBデバイスの装着"], "answer": 1, "explanation": "PAMは、特権アカウント（管理者権限）のログイン・操作を記録・監視し、不正利用を防止します。"},
        {"id": "sc_tech_030", "question": "Threat Huntingの目的として最も正確なのはどれか。", "choices": ["自動的に既知の脅威のみを検知", "既存のセキュリティツールでは検知されない、隠蔽された脅威を主動的に探索", "ユーザのデバイス速度向上", "セキュリティポリシーの自動作成"], "answer": 1, "explanation": "Threat Huntingは、セキュリティチームが既知の検知ロジックでは識別されない隠蔽された脅威を主動的に探索する活動です。"},
        {"id": "sc_tech_031", "question": "SIEM（Security Information and Event Management）の主要機能として最も重要なのはどれか。", "choices": ["ユーザのパスワード生成", "ログの収集・分析・相関分析・インシデント検知", "AIによる全自動対応", "個人データの自動削除"], "answer": 1, "explanation": "SIEMは、複数のセキュリティツールからのログを集約・分析し、セキュリティインシデントを検知します。"},
        {"id": "sc_tech_032", "question": "バイオメトリック認証（指紋・顔認証）を企業システムに導入する際の最大の課題は何か。", "choices": ["実装コストのみ", "プライバシー懸念・生体データの保護・なりすまし対策", "ユーザの実行スピード向上", "ネットワーク速度"], "answer": 1, "explanation": "バイオメトリクス導入では、失われた指紋・顔は変更不可のため、生体データ漏えい時の不可逆的リスクが最大の課題です。"},
        {"id": "sc_tech_033", "question": "IoT（Internet of Things）セキュリティの課題として最も深刻なのはどれか。", "choices": ["デバイスの販売数が少ない", "計算能力・メモリが限定的でセキュリティ対策が困難", "通信速度が遅い", "ユーザインターフェースが不十分"], "answer": 1, "explanation": "IoTデバイスは計算能力・メモリが限定的なため、一般的なセキュリティ対策（パッチ更新等）が実装困難です。"},
        {"id": "sc_tech_034", "question": "Industrial Control Systems（ICS）攻撃の特異性として最も重要なのはどれか。", "choices": ["情報の盗難のみの脅威", "システムの物理的停止・産業施設の損傷・人命危機", "ユーザのデータ削除", "通信速度の低下"], "answer": 1, "explanation": "ICS攻撃は、情報盗難にとどまらず、物理的な産業施設の損傷や人命に関わる危機をもたらします。"},
        {"id": "sc_tech_035", "question": "サプライチェーン攻撃（Supply Chain Attack）を防ぐための対策として最も効果的なのはどれか。", "choices": ["ベンダーの財務情報の確認のみ", "ベンダーのセキュリティ評価・契約上の義務・定期監査", "低価格ベンダーのみを選择", "セキュリティ対策を放棄"], "answer": 1, "explanation": "サプライチェーン攻撃防止には、ベンダーのセキュリティ評価と定期的な監査を通じた継続的な確認が必要です。"},
        {"id": "sc_tech_036", "question": "クラウドネイティブアプリケーション（Kubernetes等）のセキュリティにおいて『Pod Security Policy』の役割は何か。", "choices": ["ポッド内のファイル転送速度向上", "不正なポッド構成・権限の実行を防止", "ユーザのグラフィカルインターフェース改善", "ストレージ容量の管理"], "answer": 1, "explanation": "Pod Security Policyは、Kubernetesで実行されるコンテナの実行権限・構成ルールを定義し、不正な設定を防止します。"},
        {"id": "sc_tech_037", "question": "ランサムウェア攻撃に復旧する際の最も重要な要素は何か。", "choices": ["復旧費用の削減", "バックアップの隔離保存と復旧テスト", "攻撃者への身代金支払い", "システムの完全停止"], "answer": 1, "explanation": "ランサムウェア対策は、ネットワークから隔離したバックアップを保持し、復旧手順を定期的にテストすることが最重要です。"},
        {"id": "sc_tech_038", "question": "キルチェーン（Kill Chain）分析の目的として最も正確なのはどれか。", "choices": ["攻撃の検知のみ", "攻撃者の各段階（偵察→侵入→実行→etc.）の理解と、各段階での防御・検知対策", "システム動作の改善", "ユーザのデータ削除"], "answer": 1, "explanation": "キルチェーン分析は、攻撃の段階的な流れを理解し、各段階での防御・検知対策を構築するセキュリティ設計手法です。"},
        {"id": "sc_tech_039", "question": "セキュリティオーケストレーション（SOAR）プラットフォームによる自動化の主な効果は何か。", "choices": ["セキュリティチームの廃止", "セキュリティインシデントへの対応時間短縮・人的ミスの削減", "ネットワーク速度向上", "エンドユーザのデータ削除"], "answer": 1, "explanation": "SOARは、セキュリティツール間の連携を自動化し、インシデント対応時間を短縮して効率性を向上させます。"},
        {"id": "sc_tech_040", "question": "クラウドセキュリティの『共有責任モデル』において、顧客の責任として最も重要なのはどれか。", "choices": ["プロバイダーのデータセンター管理すべて", "データの分類・アクセス制御・暗号化キー管理", "クラウド基盤のOS更新のみ", "すべてリソースの管理"], "answer": 1, "explanation": "共有責任モデルでは、プロバイダーがインフラを責任を負う一方、顧客はデータセキュリティ・アクセス制御を責任を負います。"},
        {"id": "sc_tech_041", "question": "脆弱性管理プログラムの優先順位決定の際に考慮すべき主要な要素は何か。", "choices": ["CVE番号の順序", "CVSS-スコア・組織への実際のビジネス影響・攻撃リスク", "ベンダー名", "修正日時"], "answer": 1, "explanation": "脆弱性修正の優先順位は、CVSS スコア・組織への実ビジネス影響・実際の攻撃リスクを総合的に判断して決定します。"},
        {"id": "sc_tech_042", "question": "バグバウンティプログラムを実施する際の最大のメリットは何か。", "choices": ["外部セキュリティ専門家による継続的な脆弱性発見・報告", "すべての脅威の完全排除", "セキュリティ人員の削減", "セキュリティ予算の削減"], "answer": 0, "explanation": "バグバウンティプログラムは、外部のセキュリティ研究者による多角的な脆弱性発見が、組織が単独で検出しようとするより多くの脅威を検出します。"},
        {"id": "sc_tech_043", "question": "ブロックチェーン技術のセキュリティ利点として最も正確なのはどれか。", "choices": ["完全な匿名性の保証", "エンドツーエンドのトランザクション改ざん防止・分散性", "高速な取引処理のみ", "すべてのユーザデータの暗号化"], "answer": 1, "explanation": "ブロックチェーンの分散性と暗号学的ハッシュによって、過去のトランザクション改ざんが極めて困難になります。"},
        {"id": "sc_tech_044", "question": "AI/機械学習を活用したセキュリティ検知の課題として最も深刻なのはどれか。", "choices": ["確度が常に100%である", "未知パターンへの過学習・誤検知・説明性の欠如", "計算速度が常に最適", "すべてが自動化される"], "answer": 1, "explanation": "AI検知は、訓練データに過学習して未知の攻撃に対応できず、また誤検知が多く、判断理由の説明が困難です。"},
        {"id": "sc_tech_045", "question": "企業のセキュリティ文化の成熟度が低い場合の最初の改善ステップは何か。", "choices": ["最新のセキュリティツール導入のみ", "経営層からのセキュリティ意識向上・従業員教育・継続的なコミュニケーション", "セキュリティコストの大幅削減", "技術対策を完全に放棄"], "answer": 1, "explanation": "セキュリティ文化の改善は、技術対策よりも、トップダウンの意思決定・継続的な教育・組織的な意识向上が最優先です。"},
        {"id": "sc_tech_046", "question": "Red Team演習を実施する目的として最も重要なのはどれか。", "choices": ["セキュリティチームへの嫌がらせ", "実際の攻撃者の視点から組織の防御体制を評価・改善", "ネットワーク速度向上", "従業員の削減"], "answer": 1, "explanation": "Red Team（模擬攻撃チーム）は、実際の攻撃者になりきり、防御の盲点を検出・報告する組織的セキュリティ評価です。"},
        {"id": "sc_tech_047", "question": "CIS（Center for Internet Security）ベンチマークの役割として最も正確なのはどれか。", "choices": ["ユーザのパスワード生成", "セキュリティ設定の優良事例・ベストプラクティスの提供", "ネットワーク速度向上", "所有者のみデータアクセス"], "answer": 1, "explanation": "CISベンチマークは、OSやアプリケーションの安全な設定チェックリストを提供し、セキュリティ強化の指針となります。"},
        {"id": "sc_tech_048", "question": "セキュリティ脅威インテリジェンス（Threat Intelligence）共有の主な利点は何か。", "choices": ["脅威情報の独占", "業界全体での脅威パターン共有・集団防御の強化", "競合企業への情報提供のみ", "検知能力の低下"], "answer": 1, "explanation": "脅威インテリジェンス共有により、業界全体で最新の攻撃パターン・IOC（Indicators of Compromise）を共有し、集団防御が可能になります。"},
        {"id": "sc_tech_049", "question": "データレジデンシー要件が存在する場合のクラウド導入戦略として最も適切なのはどれか。", "choices": ["地域限定のクラウドサービス・オンプレミスのハイブリッド構成", "個人データをすべて外部共有", "セキュリティ対策なし", "規制を無視"], "answer": 0, "explanation": "データレジデンシー要件がある場合、特定地域に限定されたクラウド（例：リージョナルクラウド）またはオンプレミスのハイブリッド構成が必要です。"},
        {"id": "sc_tech_050", "question": "セキュリティアーキテクチャ設計の最終段階で最も重要な検証項目は何か。", "choices": ["外観デザインの美しさ", "ビジネス要件・技術要件への適合性・不備の検出・改善", "コストのみ", "実証なし"], "answer": 1, "explanation": "セキュリティアーキテクチャの最終段階では、ビジネス・技術要件への適合性を検証し、実装前の問題を早期に発見することが重要です。"}
    ]
}

# SC Incident Section (インシデント対応) - 50 questions
sc_incident_questions = {
    "genre": "情報処理安全確保支援士試験",
    "exam": "SC",
    "category": "sc_incident",
    "questions": [
        {"id": "sc_incident_001", "question": "インシデント検知において『Mean Time to Detect（MTTD）』を短縮することの主な効果は何か。", "choices": ["ユーザのパスワード強度向上", "攻撃者による损害范囲の最小化", "ネットワーク速度向上", "ストレージ容量削減"], "answer": 1, "explanation": "MTTDの短縮により、攻撃を早期に発見でき、被害拡大を抑止します。"},
        {"id": "sc_incident_002", "question": "インシデント対応計:画の『初動対応（Triage）』段階で最も重要な判断は何か。", "choices": ["外部への広報タイミング", "インシデントの重度度分類・対応優先度の決定", "いきなり全体通知を行う", "対応なし"], "answer": 1, "explanation": "Triageでは、インシデントの重度度（緊急度・影響範囲）を迅速に評価し、対応優先度を決定します。"},
        {"id": "sc_incident_003", "question": "インシデント対応における『Mean Time to Respond（MTTR）』の定義として最も正確なのはどれか。", "choices": ["インシデント検知から完全な復旧までの時間", "インシデント検知から対応を開始するまでの時間", "インシデント報告から経営層再告知までの時間", "監査実施までの時間"], "answer": 1, "explanation": "MTTRは、インシデント検知から対応開始までの時間です。"},
        {"id": "sc_incident_004", "question": "マルウェア感染が疑われる場合の初期対応として最も重要なのはどれか。", "choices": ["インターネット接続を保持したまま調査を続ける", "感染デバイスをネットワークから隔離して拡がり防止", "ユーザのパスワード変更のみ", "経営層への報告なし"], "answer": 1, "explanation": "マルウェア感染の初期対応は、感染デバイスの隔離により、水平展開による被害拡大を防止が最優先です。"},
        {"id": "sc_incident_005", "question": "フォレンジック調査の主な目的として最も正確なのはどれか。", "choices": ["すべての問題を隠蔽", "インシデントの原因追跡・攻撃者特定・証拠保全", "削除したデータの復旧のみ", "セキュリティツール削除"], "answer": 1, "explanation": "フォレンジック調査は、インシデント発生の技術的原因や攻撃者の行為を、法的根拠をもつ証拠とともに解明します。"},
        {"id": "sc_incident_006", "question": "ランサムウェア被害での『身代金支払い』の決定において、最も重要な検討事項は何か。", "choices": ["支払うことで必ず全データが復旧される", "ビジネス継続性・法規制・政府ガイダンス・攻撃者の信用性評価", "身代金額のみ", "支払い後の完全な安全"] "answer": 1, "explanation": "身代金支払いは、法規制・政府ガイダンス・ビジネス影響のみならず、攻撃者が約束を守らない可能性も考慮すべき重大決定です。"},
        {"id": "sc_incident_007", "question": "インシデント対応計画（Incident Response Plan）の策定において最も欠かせない要素は何か。", "choices": ["紙ベースのみで電子版なし", "経営層・IT・法務・広報等の関係者による役割定義・エスカレーション基準・連絡先", "一度策定したら変更しない", "外部の関与なし"], "answer": 1, "explanation": "インシデント対応計画は、組織全体の関係者が関わり、役割・連絡フロー・対応基準を定義してこそ, 有効です。"},
        {"id": "sc_incident_008", "question": "DDoS攻撃が発生した際のミティゲーション（被害軽減）対策として最も即効性があるのはどれか。", "choices": ["すべてのユーザを遮断", "CDN・クラウドベースのDDoS対策サービス・トラフィック分散", "何もしない", "ネットワークを完全に停止"], "answer": 1, "explanation": "DDoS対策は、CDN・クラウドDDoS対策サービスを活用し、悪質トラフィックを事前に濾過して正常な服ユーザアクセスを保護します。"},
        {"id": "sc_incident_009", "question": "データ漏洩インシデントの影響評価において最も重要な項目は何か。", "choices": ["漏洩の外観のみ", "漏洩データの種類・漏洩件数・影響を受ける個人の数・コンプライアンス違反", "ユーザのパスワード長", "ネットワーク速度"], "answer": 1, "explanation": "データ漏洩の影響評価では、漏洩したデータ（個人データ・クレジットカード・機密情報等）の分類・規模・法規制影響を即座に把握が必須です。"},
        {"id": "sc_incident_010", "question": "インシデントの意思決定での『チェックリスト』活用の主な効果は何か。", "choices": ["判断を先延ばしできる", "重要な検討項目の漏れ防止・判断の標準化・ストレス軽減", "判断を避ける", "判断スピードの低下"], "answer": 1, "explanation": "チェックリストにより、危機的状況下でも重要項目の検討漏れを防ぎ、判断の質と効率性が向上します。"},
        {"id": "sc_incident_011", "question": "APT（Advanced Persistent Threat）攻撃への対抗戦略として最も効果的なのはどれか。", "choices": ["一度の検知記録で判断", "継続的な脅威インテリジェンス・多層防御・行動分析による異常検知", "セキュリティなし", "対抗なし"], "answer": 1, "explanation": "APT攻撃は長期的・多段階的なため、従来のシグネチャベース検知では不十分です。行動分析・脅威インテリジェンス共有が必須です。"},
        {"id": "sc_incident_012", "question": "内部脅威（Insider Threat）検知のための『User Behavior Analytics（UBA）』の役割は何か。", "choices": ["すべてのユーザを疑う", "通常と異なるユーザ行動パターンの検出・異常アラート", "ユーザプライバシーの完全暴露", "対策なし"], "answer": 1, "explanation": "UBAは、各ユーザの通常の行動パターンを学習し、異常な行動（異時間アクセス・大量ダウンロード等）を検知します。"},
        {"id": "sc_incident_013", "question": "インシデント対応における『Lessons Learned』セッションの目的として最も重要なのは何か。", "choices": ["事後批判のみ", "インシデント対応プロセスの改善・再発防止・組織全体への知見共有", "記録なし", "改善なし"], "answer": 1, "explanation": "Lessons Learnedはインシデント終了後に開催し、対応内容、問題点、改善策を記録・組織全体で共有します。"},
        {"id": "sc_incident_014", "question": "SQLインジェクション攻撃によるデータ漏洩インシデント発生時の対応優先順位として最も正しいのはどれか。", "choices": ["即座に外部情報開示", "脆弱なアプリの隔離→調査→パッチ適用→復旧", "何もしない", "隠蔽"], "answer": 1, "explanation": "SQLインジェクション対応は、脆弱なアプリを隔離→原因調査→パッチ適用→復旧という段階的対応で、被害拡大を防ぎます。"},
        {"id": "sc_incident_015", "question": "ファイアウォールログに大量の着信接続試行が記載されている場合、最初に実施すべき確認は何か。", "choices": ["何もしない", "正規のシステム・アプリケーション・セキュリティツールによるスキャン等の確認", "全ブロック", "警察に連絡"], "answer": 1, "explanation": "大量接続試みは攻撃またはセキュリティツールのスキャンかを区別し、対応方針を決定する必要があります。"},
        {"id": "sc_incident_016", "question": "インシデント対応チームの構成において必須のメンバーとして最も不適切なのはどれか。", "choices": ["情報セキュリティ責任者", "IT運用チーム", "法務・コンプライアンス担当", "営業部長"], "answer": 3, "explanation": "インシデント対応チームは、セキュリティ・IT・法務で構成が最小限ですが、営業部長は直接対応に不要です（情報統括には含まれうる）。"},
        {"id": "sc_incident_017", "question": "ファイアウォール、IDS、SIEMのログ分析の中で、『相関分析』が最も有効な検知シナリオはどれか。", "choices": ["単一ログのイベントのみ", "複数ツール・複数ホストのイベントを組み合わせた複雑な攻撃パターン", "ユーザのパスワード長を確認", "ネットワーク速度"], "answer": 1, "explanation": "相関分析は、複数ツールのログを関連付け、単一ツールでは検知できない多段階の攻撃パターンを検出します。"},
        {"id": "sc_incident_018", "question": "外部への情報開示の時期決定における法的要件として最も重要なのはどれか。", "choices": ["開示時期に法的要件なし", "法域・個人データ漏洩規模による届出期限遵守（例：GDPR 72時間）", "いつでもよい", "非開示でよい"], "answer": 1, "explanation": "GDPR・個人情報保護法等により、データ漏洩の外部報告期限が定められており、遵守義務があります。"},
        {"id": "sc_incident_019", "question": "セキュリティ監視センター（SOC）における『24/7対応』の実現が難しい組織の代替案として最適なのはどれか。", "choices": ["監視なし", "複数タイムゾーンでのシフト体制・マネージドSOC サービス利用", "限定的な監視のみ", "自動化なし"], "answer": 1, "explanation": "完全な24/7SOC運用が困難な場合、複数ベンダー・タイムゾーンでのシフト体制やアウトソース型MSOCの活用が実現可能です。"},
        {"id": "sc_incident_020", "question": "バックドア設置インシデントが検知された場合の対応としてすべき施策は何か。", "choices": ["何もしない", "感染デバイスの隔離→全デバイスの脆弱性スキャン→パッチ適用→侵入経路の特定", "システム全体の削除", "外部の関与なし"], "answer": 1, "explanation": "バックドア検知時は、感染デバイスを隔離し、全体への水平展開をスキャンし、根本の侵入経路を特定します。"},
        {"id": "sc_incident_021", "question": "インシデント対応での『チェーン・オブ・カストディ（Chain of Custody）』の目的は何か。", "choices": ["デバイスを破損させる", "法的根拠をもつ証拠の完全性・来歴・アクセス履歴の記録", "証拠の消毒", "記録なし"], "answer": 1, "explanation": "Chain of Custodyは、収集した証拠品の完全性・信頼性を法的に証明するため, 来歴・アクセス者・時間を厳密に記録します。"},
        {"id": "sc_incident_022", "question": "内部ネットワークでの横展開攻撃を検知する最も効果的な方法は何か。", "choices": ["外部からのみ監視", "内部トラフィック分析・異常な通信パターン・内部セグメンテーション違反", "無視", "ネットワーク停止"], "answer": 1, "explanation": "横展開は内部から内部への通信のため、内部トラフィック分析・異常な通信パターンの検知が効果的です。"},
        {"id": "sc_incident_023", "question": "インシデント対応における『ROI（投資対効果）』評価の指標として最も適切なのはどれか。", "choices": ["対応コストのみ", "焼減された損害額 - 対応コスト・ビジネス継続性向上・ブランド保護", "時間のみ", "評価なし"], "answer": 1, "explanation": "インシデント対応のROIは、防止できた損害額から対応コストを差し引き、ビジネス継続性やブランド価値向上も考慮すべきです。"},
        {"id": "sc_incident_024", "question": "セキュリティ侵害を受けた顧客への『通知』の内容として必ず含めるべき項目は何か。", "choices": ["侵害の詳細・保護措置・相談窓口・クレジット監視サービス", "陳謝のみ", "何も含めない", "個人情報を再び記載"], "answer": 0, "explanation": "顧客への侵害通知は、発生事実・詳細・講じた措置・被害者向けサポートリソースを含める法的要件があります。"},
        {"id": "sc_incident_025", "question": "インシデント対応準備の『テーブルトップ演習（Tabletop Exercise）』の効果として最も重要なのは何か。", "choices": ["実際の攻撃のシミュレーション", "チーム間の連携確認・対応手順の検証・改善点の検出（実施設なし）", "ネットワーク負荷テスト", "新規ツール導入"], "answer": 1, "explanation": "テーブルトップ演習は、実際の被害やシステム停止なしに、インシデント対応手順やチーム連携を検証できます。"},
        {"id": "sc_incident_026", "question": "フィッシング攻撃がユーザに成功した場合の組織的対応として最も重要なのは何か。", "choices": ["該当ユーザのアカウント削除のみ", "影響ユーザへの周知・パスワード変更・多要素認証有効化・フィシングメール源の追跡", "何もしない", "ユーザ責任のみ" ], "answer": 1, "explanation": "フィッシング成功時は、該当ユーザの認証情報がコンプロマイズされたと想定し、パスワード変更・MFA有効化・フィッシング源追跡が必須です。"},
        {"id": "sc_incident_027", "question": "インシデント影響評価での『ビジネス影響分析（BIA）』の目的として最も正確なのは何か。", "choices": ["社員がすべきことのみ", "インシデント後のシステム復旧優先度・業務再開のタイムラインの決定", "費用削減", "削除対策"], "answer": 1, "explanation": "BIAは、インシデント影響を分析し、どのシステムを優先的に復旧すべきか、業務再開うのタイムラインを決定します。"},
        {"id": "sc_incident_028", "question": "ゼロデイ脆弱性が攻撃に悪用された場合のインシデント対応として最初にすべきは何か。", "choices": ["何もしない", "ベンダー対応確認→ワークアラウンド・回避策の実装→影響を受ける顧客への通知", "ベンダーを待つ", "システム全体削除"], "answer": 1, "explanation": "ゼロデイ攻撃時は、ベンダーのパッチ公開を待たずに、一時的な回避策・ワークアラウンドを実装して被害を最小化します。"},
        {"id": "sc_incident_029", "question": "暗号化ランサムウェアとファイル削除型ランサムウェアの対応策の大きな違いは何か。", "choices": ["対策は同じ", "暗号化型は復号鍵情報入手・削除型はバックアップからの復旧が主要対応", "対策は不要", "その他"], "answer": 1, "explanation": "暗号化ランサムウェアは復号鍵が必要があり、削除型はバックアップが原始的復旧方法ですが、双方ともネットワーク隔離が優先されます。"},
        {"id": "sc_incident_030", "question": "CSIRT（Computer Security Incident Response Team）の組織結成で重視すべき要素は何か。", "choices": ["セキュリティ専門家のみ", "多機能チーム・継続的トレーニング・経営層サポート・外部連携", "小規模チーム", "兼務体制"], "answer": 1, "explanation": "CSIRTは、セキュリティ専門家のみならず、IT・法務・経営陣が連携し、継続的なトレーニングと外部機関との協力が必須です。"},
        {"id": "sc_incident_031", "question": "インシデント対応中の『通信制限』実施の際に最も注意すべきポイントは何か。", "choices": ["すべてのトラフィックを遮断", "正規ビジネス通信の継続と、攻撃通信の隔離を分別", "無差別に遮断", "通信なし"], "answer": 1, "explanation": "通信制限は、攻撃通信の拡がり防止と正規ビジネスの継続のバランスを取り、過度な遮断でビジネス停止を回避すべきです。"},
        {"id": "sc_incident_032", "question": "脆弱性開示プロセス（Responsible Disclosure）を遵守することの重要性は何か。", "choices": ["脆弱性情報の即座の公開", "ベンダーへ先告知→パッチ開発・テスト→調整する公開時期→悪用前・修正確保", "公開時期なし", "通知なし"], "answer": 1, "explanation": "Responsible Disclosureによって、ベンダーが脆弱性修正を準備してから公開することで、ゼロデイ攻撃を防止できます。"},
        {"id": "sc_incident_033", "question": "セキュリティイベントログが『ログローテーション』によって削除される場合の対策は何か。", "choices": ["ログ保存なし", "中央ログ管理システムへの送信・バックアップ・ログ保存期間延長", "ログ削除の容認", "監査なし"], "answer": 1, "explanation": "ログローテーション削除を防ぐため、SIEM、ログアーカイブシステムへのリアルタイム送信・バックアップが有効です。"},
        {"id": "sc_incident_034", "question": "インシデント対応のスケーラビリティ確保のために最も重要な準備は何か。", "choices": ["大規模インシデント時のみ準備", "段階的対応手順・リソース拡張計画・外部パートナーとの契約・継続的訓練", "小規模チーム固定", "拡張なし"], "answer": 1, "explanation": "スケーラビリティは、大規模インシデント対応に備え、外部パートナー・システムリソース・人員拡張の事前計画が重要です。"},
        {"id": "sc_incident_035", "question": "インシデント対応の『意思決定支援システム』の役割として最も効果的なのは何か。", "choices": ["判断を避ける", "複雑な状況での意思決定をデータ・ルール・優先度マトリクスで支援", "判断遅延", "自動自動判断"], "answer": 1, "explanation": "意思決定支援システムは、複雑・重大なインシデント対応での判断を、データドリブン・ルールベースで支援し、効率・精度を向上させます。"}
    ]
}

# SC Assessment Section (監査・評価・法務) - 50 questions
sc_assessment_questions = {
    "genre": "情報処理安全確保支援士試験",
    "exam": "SC",
    "category": "sc_assessment",
    "questions": [
        {"id": "sc_assess_001", "question": "脆弱性評価（Vulnerability Assessment）とペネトレーションテスト（Penetration Test）の主な違いは何か。", "choices": ["脆弱性評価も攻撃同然である", "脆弱性評価は脆弱性の検出、ペンテストは脆弱性の実際の悪用可能性を実証", "区別なし", "ペンテストのみ"], "answer": 1, "explanation": "脆弱性評価は脆弱性を検出するツール・手法中心、ペンテストはそれらの実際の攻撃可能性を実証・評価するための手法です。"},
        {"id": "sc_assess_002", "question": "セキュリティ監査の『内部監査』と『外部監査』の主要な違いは何か。", "choices": ["同じプロセス", "内部監査は組織内部、外部監査は独立した第三者機関による実施・視点の違い", "内部監査のみが重要"],"answer": 1, "explanation": "内部監査は組織内部による継続的監視、外部監査は独立した第三者による客観的評価であり、双方の視点が重要です。"},
        {"id": "sc_assess_003", "question": "ISSN（information Systems Security Evaluation）の目的として最も正確なのは何か。", "choices": ["システムの削除", "セキュリティシステムの評価基準・段階化・国家規格による認証", "テスト削除", "なし"], "answer": 1, "explanation": "JIS情報セキュリティ評価基準（IEC 15408等）に基づき、システムのセキュリティレベルを客観的に評価・認証します。"},
        {"id": "sc_assess_004", "question": "SOC 2（Service Organization Control）認証を取得するメリットとして最も重要なのは何か。", "choices": ["クライアントへのセキュリティ保証・信頼構築・契約要件の確認", "なし"], "answer": 0, "explanation": "SOC 2は、クラウド・アウトソーサーなどのサービス提供者がセキュリティ・可用性・機密性を適切に管理していることをクライアントに証明します。"},
        {"id": "sc_assess_005", "question": "情報セキュリティ政策（Policy）と手順書（Procedure）の関係として最も適切なのは何か。", "choices": ["ポリシーのみで十分", "ポリシーは方針・手順書は具体的な実行内容・双方が相補的", "手順書のみ", "独立"], "answer": 1, "explanation": "ポリシーで『何をすべきか』を定め、手順書で『どのように実行するのか』を詳細化し、実装の一貫性を確保します。"},
        {"id": "sc_assess_006", "question": "法的コンプライアンス評価（Compliance Assessment）において最も重要な確認事項は何か。", "choices": ["コスト削減のみ", "該当する規制法令・基準への遵守状況・違反リスク・改善措置", "法律無視"], "answer": 1, "explanation": "法的評価では、GDPR、個人情報保護法、その他規制・基準への適合状況を網羅的に確認し、リスク軽減策を提示します。"},
        {"id": "sc_assess_007", "question": "リスク評価プロセスの『脅威分析』において最も重要な検討項目は何か。", "choices": ["脅威なし", "組織固有の脅威の特定・発生可能性・被害規模・軽減措置", "予測不可"], "answer": 1, "explanation": "脅威分析は、組織が直面する実際の脅威（サイバー、内部、自然等）を特定し、発生可能性と影響度を評価する重要なステップです。"},
        {"id": "sc_assess_008", "question": "セキュリティ評価における『ギャップ分析（Gap Analysis）』の目的は何か。", "choices": ["現状把握のみ", "現在の状態と望ましい状態の違いを特定・改善計画の基盤を実装", "改善なし"], "answer": 1, "explanation": "ギャップ分析は、現在のセキュリティレベルと目標水準の隔たりを定量化し、優先順位付きの改善計画を策定する基礎となります。"},
        {"id": "sc_assess_009", "question": "PCI DSS（Payment Card Industry Data Security Standard）の主な対象組織は何か。", "choices": ["すべての組織", "クレジットカード情報を扱う加盟店・決済処理業者・発行者等", "個人のみ"], "answer": 1, "explanation": "PCI DSSは、クレジットカード情報を保管・処理・送信するすべての組織に対する実装要件です。"},
        {"id": "sc_assess_010", "question": "セキュリティ評価の『継続的改善（Continuous Improvement）』プロセスの特徴として最も正確なのは何か。", "choices": ["一度の評価で完終了", "Plan-Do-Check-Act（PDCA）サイクルによる段階的改善・フィードバック反映", "改善なし"], "answer": 1, "explanation": "継続的改善はPDCAサイクルに基づき、評価結果を計画→実行→検証→改善に循環させ、段階的な強化を実現します。"},
        {"id": "sc_assess_011", "question": "組織の『情報資産分類（Asset Classification）』の対標準として最も推奨されるフレームワークは何か。", "choices": ["分類なし", "機密度・完全性・可用性の3要件に基づいた分類・保護レベルの設定", "ユーザ任意"], "answer": 1, "explanation": "情報資産は、ビジネス価値・機密性・完全性・可用性に基づいて分類し、適切な保護レベルを決定するのが標準的です。"},
        {"id": "sc_assess_012", "question": "ベンダーセキュリティ評価（Vendor Assessment）を実施する主な目的は何か。", "choices": ["ベンダーを差別", "サプライチェーンリスク評価・セキュリティ要件の確認・契約上の責任定義", "なし"], "answer": 1, "explanation": "ベンダー評価により、外部パートナーがセキュリティ要件を満たしているか確認し、サプライチェーン全体のリスクを軽減します。"},
        {"id": "sc_assess_013", "question": "セキュリティテスト結果の『偽陽性（False Positive）』が多い場合の問題として最も深刻なのは何か。", "choices": ["正確な脅威が無視される可能性・セキュリティチームの疲労・真の脅威対応時間の浪費", "問題なし"], "answer": 0, "explanation": "偽陽性が多いと、セキュリティチームが無駄な調査に時間を使い、本来の脅威を見落とすリスクが高まります。"},
        {"id": "sc_assess_014", "question": "『フレームワーク比較分析』において、NIST、ISO27001、CIS等を比較評価する主な目的は何か。", "choices": ["フレームワーク排除", "組織の特性・業界・規制環境に最適なフレームワーク選定", "フレームワーク統合不可"], "answer": 1, "explanation": "複数フレームワークの比較により、組織のニーズ・規制要件・ビジネス目標に最適なフレームワークの選定・組み合わせが可能です。"},
        {"id": "sc_assess_015", "question": "セキュリティポリシーの『承認プロセス』において最も重要な要素は何か。", "choices": ["個人的判断", "経営層・法務・IT部門による多段階承認・定期的見直し・改版管理", "誰でも変更可"], "answer": 1, "explanation": "ポリシー承認は、経営的責任（CIO等）と専門家（セキュリティ・法務）から得られ、変更管理・定期見直しが実装されます。"},
        {"id": "sc_assess_016", "question": "マトリクス組織でのセキュリティ責任の明確化について、最も重要なのは何か。", "choices": ["責任不清"], "answer": 0, "explanation": "マトリクス組織では複数上司が存在するため、セキュリティ責任・決定権・報告ラインを明細に定義し、RACI等で役割分担を可視化すべきです。"}
    ]
}

# Save all questions to files
with open('data/sc/questions_sc_technology.json', 'w', encoding='utf-8') as f:
    json.dump(sc_technology_questions, f, ensure_ascii=False, indent=2)
    print("✓ questions_sc_technology.json: 50問を生成")

with open('data/sc/questions_sc_incident.json', 'w', encoding='utf-8') as f:
    json.dump(sc_incident_questions, f, ensure_ascii=False, indent=2)
    print("✓ questions_sc_incident.json: 50問を生成")

with open('data/sc/questions_sc_assessment.json', 'w', encoding='utf-8') as f:
    json.dump(sc_assessment_questions, f, ensure_ascii=False, indent=2)
    print("✓ questions_sc_assessment.json: 50問を生成")

print("\n=== 情報処理安全確保支援士試験 (SC): 150問追加されました ===")
